DROP DATABASE IF EXISTS TANATIP_DATA;
USE ROLE accountadmin;
CREATE DATABASE IF NOT EXISTS TANATIP_DATA;

USE TANATIP_DATA;

CREATE OR REPLACE FILE FORMAT my_csv_format TYPE = CSV SKIP_HEADER = 1;

CREATE OR REPLACE STAGE TANATIP_DATA.PUBLIC.s3_stage url="s3://iris-data-tanatip/output_folder/" 
CREDENTIALS =(AWS_KEY_ID ='AKIAXUOLOK26QSESY4T3' AWS_SECRET_KEY ='m9wwB3m3ca2JRx3txnH7es8gqUdY6pJ7YrLxxxSR') FILE_FORMAT = "my_csv_format";

CREATE OR REPLACE EXTERNAL TABLE TANATIP_DATA.PUBLIC.PL_2019_2023 ( TEAM VARCHAR(30) AS (VALUE:c1::VARCHAR),PL_SEASONS INT AS (VALUE:c2::INT),TOTAL_GOALS INT AS (VALUE:c3::INT), TOTAL_CONCEDED INT AS (VALUE:c4::INT) , STD_GOALS FLOAT AS (VALUE:c5::FLOAT), STD_CONCEDED FLOAT AS (VALUE:c6::FLOAT), MIN_POINTS INT AS (VALUE:c7::INT), MAX_POINTS INT AS (VALUE:c8::INT), TOTAL_POINTS INT AS (VALUE:c9::INT)) WITH location = @TANATIP_DATA.PUBLIC.s3_stage FILE_FORMAT ='my_csv_format' PATTERN = '.*pl_data_2019_2023.*\\.csv';
CREATE OR REPLACE EXTERNAL TABLE TANATIP_DATA.PUBLIC.PL_2014_2018 (TEAM VARCHAR(30) AS (VALUE:c1::VARCHAR) , PL_SEASONS INT AS (VALUE:c2::INT), TOTAL_GOALS INT AS (VALUE:c3::INT), TOTAL_CONCEDED INT AS (VALUE:c4::INT) , STD_GOALS FLOAT AS (VALUE:c5::FLOAT), STD_CONCEDED FLOAT AS (VALUE:c6::FLOAT), MIN_POINTS INT AS (VALUE:c7::INT), MAX_POINTS INT AS (VALUE:c8::INT), TOTAL_POINTS INT AS (VALUE:c9::INT))  WITH location = @TANATIP_DATA.PUBLIC.s3_stage FILE_FORMAT  ='my_csv_format' PATTERN = '.*pl_data_2014_2018.*\\.csv';
CREATE OR REPLACE EXTERNAL TABLE TANATIP_DATA.PUBLIC.PL_2009_2013 (TEAM VARCHAR(30) AS (VALUE:c1::VARCHAR) , PL_SEASONS INT AS (VALUE:c2::INT), TOTAL_GOALS INT AS (VALUE:c3::INT), TOTAL_CONCEDED INT AS (VALUE:c4::INT) , STD_GOALS FLOAT AS (VALUE:c5::FLOAT), STD_CONCEDED FLOAT AS (VALUE:c6::FLOAT), MIN_POINTS INT AS (VALUE:c7::INT), MAX_POINTS INT AS (VALUE:c8::INT), TOTAL_POINTS INT AS (VALUE:c9::INT))  WITH location = @TANATIP_DATA.PUBLIC.s3_stage FILE_FORMAT  ='my_csv_format' PATTERN = '.*pl_data_2009_2013.*\\.csv';
CREATE OR REPLACE EXTERNAL TABLE TANATIP_DATA.PUBLIC.PL_2004_2008 (TEAM VARCHAR(30) AS (VALUE:c1::VARCHAR) , PL_SEASONS INT AS (VALUE:c2::INT), TOTAL_GOALS INT AS (VALUE:c3::INT), TOTAL_CONCEDED INT AS (VALUE:c4::INT) , STD_GOALS FLOAT AS (VALUE:c5::FLOAT), STD_CONCEDED FLOAT AS (VALUE:c6::FLOAT), MIN_POINTS INT AS (VALUE:c7::INT), MAX_POINTS INT AS (VALUE:c8::INT), TOTAL_POINTS INT AS (VALUE:c9::INT))  WITH location = @TANATIP_DATA.PUBLIC.s3_stage FILE_FORMAT  ='my_csv_format' PATTERN = '.*pl_data_2004_2008.*\\.csv';
CREATE OR REPLACE EXTERNAL TABLE TANATIP_DATA.PUBLIC.PL_1999_2003 (TEAM VARCHAR(30) AS (VALUE:c1::VARCHAR) , PL_SEASONS INT AS (VALUE:c2::INT), TOTAL_GOALS INT AS (VALUE:c3::INT), TOTAL_CONCEDED INT AS (VALUE:c4::INT) , STD_GOALS FLOAT AS (VALUE:c5::FLOAT), STD_CONCEDED FLOAT AS (VALUE:c6::FLOAT), MIN_POINTS INT AS (VALUE:c7::INT), MAX_POINTS INT AS (VALUE:c8::INT), TOTAL_POINTS INT AS (VALUE:c9::INT))  WITH location = @TANATIP_DATA.PUBLIC.s3_stage FILE_FORMAT  ='my_csv_format' PATTERN = '.*pl_data_1999_2003.*\\.csv';
CREATE OR REPLACE EXTERNAL TABLE TANATIP_DATA.PUBLIC.PL_1994_1998 (TEAM VARCHAR(30) AS (VALUE:c1::VARCHAR) , PL_SEASONS INT AS (VALUE:c2::INT), TOTAL_GOALS INT AS (VALUE:c3::INT), TOTAL_CONCEDED INT AS (VALUE:c4::INT) , STD_GOALS FLOAT AS (VALUE:c5::FLOAT), STD_CONCEDED FLOAT AS (VALUE:c6::FLOAT), MIN_POINTS INT AS (VALUE:c7::INT), MAX_POINTS INT AS (VALUE:c8::INT), TOTAL_POINTS INT AS (VALUE:c9::INT))  WITH location = @TANATIP_DATA.PUBLIC.s3_stage FILE_FORMAT  ='my_csv_format' PATTERN = '.*pl_data_1994_1998.*\\.csv';
